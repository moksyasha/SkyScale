# Сервис для Upscale видеопотока: Дизайн-Документ по Машинному Обучению

## Содержание

- [Введение](#введение)
    - [Описание Проблемы](#описание-проблемы)
    - [Цели и Задачи](#цели-и-задачи)
    - [Ограничения](#ограничения)
    - [Источники Данных](#источники-данных)
    - [Форматы Данных](#форматы-данных)
- [Используемые модели, системные требования](#используемые-модели)
    - [Выбор Алгоритмов](#выбор-алгоритмов)
    - [Системные Требования](#системные-требования)
    - [Хранение Данных](#хранение-данных)
- [Этапы Разработки](#этапы-разработки)
    - [Ресурсы и Ответственные Лица](#ресурсы-и-ответственные-лица)
- [Тестирование и Валидация](#тестирование-и-валидация)
    - [Метрики Качества](#метрики-качества)
    - [План Тестирования](#план-тестирования)
- [Поддержка](#поддержка)
- [Словарь Терминов](#словарь-терминов)
- [Дополнительные Ресурсы](#дополнительные-ресурсы)

## Введение

### Описание Проблемы

Технологии не стоят на месте. Ещё 10 лет назад контент в HD-качестве был пределом наших мечтаний. 
А сегодня телевизор с поддержкой 4K — норма. Но что делать с фильмами и любительскими видео, снятыми
в начале столетия? Необходим сервис, который улучшает качество изображения, используя при этом
минимальные производительные затраты.

### Цели

1. Разработать обучаемую модель для повышения разрешения изображений.
2. Сделать её применимой к различным видам видеопотоков.
3. Разработать модель для повышения кол-ва кадров видеопотока.
4. Реализовать сервис(api или сайт) для обычных пользователей.
5. Написать тех. документацию продукта.

### Ограничения на модель

- Отсутствие поддержки Upscale для анимации (аниме, мульфильмы) 
- Минимальное разрешение изображения - 240р, макс - 1080р. 

### Источники Данных

1. Различные датасеты с изображениями высокого разрешения(
https://github.com/XPixelGroup/BasicSR/blob/master/docs/DatasetPreparation.md#common-image-sr-datasets)

### Форматы Данных
1. 2K images from Flickr e.g. for training (jpg, png)

## Используемые модели, системные требования

### Выбор Алгоритмов

1. Обучение GAN, SRResNet моделей с различными собственными доработками.
2. Технологии для повышения fps видеопотока (интерполяция кадров видео) с помощью нейросетей.

### Системные Требования

- ОС: Windows
- Python 3.x
- Обучение модели происходит на nvidia rtx2080 8gb, принимается за около-минимальный девайс.
- Доступ в интернет

### Хранение Данных

- Локальное хранилище или облачные решения типа GoogleDrive для хранения моделей.

## Этапы Разработки и план

1. **Исследование и анализ** (1 неделя)
    - Поиск материала для разработки
    - Анализ типичных моделей.
    - Первые тестовые результаты для изображений.
2. **Тестирование, разработка собственных моделей** (3 недели)
    - Доработка SR моделей для увеличения скорости обработки.
    - Доработка/изменение моделей для повышения качества.
3. **Внедрение моделей для Upscale видеопотока** (3 недели)
    - Использование собственных моделей для видеопотока.
    - Анализ результатов, доработка моделей.
4. **Рефакторинг и оптимизация** (1 неделя)
    - Оптимизация кода и модели.
5. **Документация и развертывание, написание приложения для клиентов** (1 неделя)
    - Написание документации и инструкций.
    - Подготовка к развертыванию.

### Ресурсы и ответственные лица

- Data Scientists: Моделирование и алгоритмы.
- Backend Developers: Реализация и интеграция.
- DevOps: Развертывание и поддержка.

## Тестирование и валидация

### Метрики качества

- Peak Signal-to-Noise Ratio (PSNR) и Structural Similarity Index Measure (SSIM) evaluation metrics.
- Скорость работы над одним кадром.

### План тестирования

- Стресс-тесты на больших изображениях.
- Интеграционные тесты для проверки взаимодействия модулей.

## Поддержка

- Подробные инструкции для использования приложения.
- План по мониторингу и обновлению моделей.

## Словарь терминов

- Upscale — это перевод видео из меньшего разрешения в большее
- Интерполяция кадров — это процесс создания промежуточных видеокадров на основе данных 
  в двух последовательных кадрах закодированного видео.
- Порождающие состязательные сети (англ. Generative Adversarial Nets, GAN) — алгоритм машинного
- обучения, входящий в семейство порождающих моделей и построенный на комбинации из двух нейронных
- сетей: генеративная модель G, которая строит приближение распределения данных, и дискриминативная
- модель D, оценивающая вероятность, что образец пришел из тренировочных данных.


## Дополнительные материалы

- Обзоры алгоритмов машинного обучения
  https://arxiv.org/abs/1512.03385
  https://arxiv.org/abs/2105.08826
  https://arxiv.org/pdf/2106.03727.pdf
- сgan